<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Label Management System</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="app">
        <!-- Left Navigation -->
        <nav class="nav-sidebar" id="nav-sidebar">
            <div class="nav-header">
                <svg class="nav-hamburger" width="18" height="14" viewBox="0 0 18 14"><path d="M0 1h18M0 7h18M0 13h18" fill="none" stroke="currentColor" stroke-width="2"/></svg>
                <span class="nav-title">Label System</span>
            </div>
            <a class="nav-item" data-section="customer">Customer</a>
            <a class="nav-item" data-section="supplier">Supplier</a>
            <a class="nav-item" data-section="template">Template</a>
            <a class="nav-item" data-section="project">Project</a>
            <a class="nav-item" data-section="order">Order</a>
            <a class="nav-item" data-section="status">Status</a>
        </nav>

        <!-- Right Content Area -->
        <main class="content-area" id="content-area">
            <div class="workspace-tabs" id="workspace-tabs">
                <a class="workspace-tab active" data-section="welcome" data-permanent="true">Welcome</a>
            </div>

            <!-- ==================== WELCOME ==================== -->
            <section class="section-panel active" id="section-welcome"></section>

            <!-- ==================== CUSTOMER ==================== -->
            <section class="section-panel" id="section-customer">
                <!-- Top tabs -->
                <div class="tab-bar">
                    <a class="tab active" data-tab="customer-create">Create</a>
                    <a class="tab" data-tab="customer-view">View &amp; Edit</a>
                </div>

                <!-- Create: Company + Member sub-tabs -->
                <div class="tab-content active" id="tab-customer-create">
                    <div class="sub-tab-bar">
                        <a class="sub-tab active" data-subtab="cust-company">Company</a>
                        <a class="sub-tab" data-subtab="cust-member">Member</a>
                    </div>

                    <div class="sub-tab-content active" id="subtab-cust-company">
                        <form id="form-customer-create" class="form-panel" autocomplete="off">
                            <div class="hp-field"><input type="text" name="website" tabindex="-1" autocomplete="off"></div>
                            <label for="cust-company">Company Name</label>
                            <input type="text" id="cust-company" required>
                            <label for="cust-domain">Email Domain</label>
                            <input type="text" id="cust-domain" placeholder="example.com" required>
                            <label for="cust-address">Address</label>
                            <textarea id="cust-address" rows="2"></textarea>
                            <label for="cust-phone">Phone</label>
                            <input type="text" id="cust-phone">
                            <div class="form-actions">
                                <button type="submit">Save</button>
                                <button type="reset" class="btn-outline">Cancel</button>
                                <button type="button" class="btn-outline btn-dummy" data-form="customer-create">Dummy</button>
                            </div>
                        </form>
                    </div>

                    <div class="sub-tab-content" id="subtab-cust-member">
                        <form id="form-customer-member" class="form-panel" autocomplete="off">
                            <div class="hp-field"><input type="text" name="website" tabindex="-1" autocomplete="off"></div>
                            <label for="cust-member-company">Company</label>
                            <select id="cust-member-company"></select>
                            <label for="cust-member-name">Member Name</label>
                            <input type="text" id="cust-member-name" required>
                            <label for="cust-member-email">Email</label>
                            <input type="email" id="cust-member-email" required>
                            <label for="cust-member-role">Role</label>
                            <input type="text" id="cust-member-role">
                            <label for="cust-member-phone">Phone</label>
                            <input type="text" id="cust-member-phone">
                            <div class="form-actions">
                                <button type="submit">Save</button>
                                <button type="reset" class="btn-outline">Cancel</button>
                                <button type="button" class="btn-outline btn-dummy" data-form="customer-member">Dummy</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- View & Edit -->
                <div class="tab-content" id="tab-customer-view">
                    <div class="table-toolbar">
                        <input type="text" id="cust-search" placeholder="Search customers...">
                    </div>
                    <div class="table-wrap">
                        <table id="table-customers">
                            <thead><tr><th>Company</th><th>Domain</th><th>Phone</th><th>Members</th><th></th></tr></thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ==================== SUPPLIER ==================== -->
            <section class="section-panel" id="section-supplier">
                <div class="tab-bar">
                    <a class="tab active" data-tab="supplier-create">Create</a>
                    <a class="tab" data-tab="supplier-view">View &amp; Edit</a>
                </div>

                <div class="tab-content active" id="tab-supplier-create">
                    <div class="sub-tab-bar">
                        <a class="sub-tab active" data-subtab="sup-company">Company</a>
                        <a class="sub-tab" data-subtab="sup-member">Member</a>
                    </div>

                    <div class="sub-tab-content active" id="subtab-sup-company">
                        <form id="form-supplier-create" class="form-panel" autocomplete="off">
                            <div class="hp-field"><input type="text" name="website" tabindex="-1" autocomplete="off"></div>
                            <label for="sup-company">Company Name</label>
                            <input type="text" id="sup-company" required>
                            <label for="sup-domain">Email Domain</label>
                            <input type="text" id="sup-domain" placeholder="example.com" required>
                            <label for="sup-address">Address</label>
                            <textarea id="sup-address" rows="2"></textarea>
                            <label for="sup-phone">Phone</label>
                            <input type="text" id="sup-phone">
                            <div class="form-actions">
                                <button type="submit">Save</button>
                                <button type="reset" class="btn-outline">Cancel</button>
                                <button type="button" class="btn-outline btn-dummy" data-form="supplier-create">Dummy</button>
                            </div>
                        </form>
                    </div>

                    <div class="sub-tab-content" id="subtab-sup-member">
                        <form id="form-supplier-member" class="form-panel" autocomplete="off">
                            <div class="hp-field"><input type="text" name="website" tabindex="-1" autocomplete="off"></div>
                            <label for="sup-member-company">Company</label>
                            <select id="sup-member-company"></select>
                            <label for="sup-member-name">Member Name</label>
                            <input type="text" id="sup-member-name" required>
                            <label for="sup-member-email">Email</label>
                            <input type="email" id="sup-member-email" required>
                            <label for="sup-member-role">Role</label>
                            <input type="text" id="sup-member-role">
                            <label for="sup-member-phone">Phone</label>
                            <input type="text" id="sup-member-phone">
                            <div class="form-actions">
                                <button type="submit">Save</button>
                                <button type="reset" class="btn-outline">Cancel</button>
                                <button type="button" class="btn-outline btn-dummy" data-form="supplier-member">Dummy</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="tab-content" id="tab-supplier-view">
                    <div class="table-toolbar">
                        <input type="text" id="sup-search" placeholder="Search suppliers...">
                    </div>
                    <div class="table-wrap">
                        <table id="table-suppliers">
                            <thead><tr><th>Company</th><th>Domain</th><th>Phone</th><th>Members</th><th></th></tr></thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ==================== TEMPLATE ==================== -->
            <section class="section-panel" id="section-template">
                <div class="tab-bar">
                    <a class="tab active" data-tab="template-create">Create</a>
                    <a class="tab" data-tab="template-view">View All</a>
                </div>

                <!-- Create: Template → Partition → Component sub-tabs -->
                <div class="tab-content active" id="tab-template-create">
                    <div class="sub-tab-bar">
                        <a class="sub-tab active" data-subtab="tpl-setup">Template</a>
                        <a class="sub-tab disabled" data-subtab="tpl-partition">Partition</a>
                        <a class="sub-tab disabled" data-subtab="tpl-component">Component</a>
                    </div>

                    <!-- Sub-tab: Template setup -->
                    <div class="sub-tab-content active" id="subtab-tpl-setup">
                        <div class="template-layout">
                            <div class="template-form" style="width:200px">
                                <form id="form-template-create" autocomplete="off">
                                    <div class="hp-field"><input type="text" name="website" tabindex="-1" autocomplete="off"></div>
                                    <label for="tpl-customer">Customer</label>
                                    <select id="tpl-customer"></select>
                                    <label for="tpl-name">Template Name</label>
                                    <input type="text" id="tpl-name" required>
                                    <fieldset>
                                        <legend>Size &amp; Orientation</legend>
                                        <div class="input-row">
                                            <div><label for="tpl-width">Width (mm)</label><input type="number" id="tpl-width" min="0" max="500" step="1"></div>
                                            <button type="button" class="btn-swap" id="btn-swap-wh" title="Swap width and height"><svg width="16" height="16" viewBox="0 0 16 16"><path d="M1 4l3-3v2h5v2H4v2L1 4zm14 8l-3 3v-2H7v-2h5V9l3 3z" fill="currentColor"/></svg></button>
                                            <div><label for="tpl-height">Height (mm)</label><input type="number" id="tpl-height" min="0" max="500" step="1"></div>
                                        </div>
                                        <label>Orientation</label>
                                        <input type="hidden" id="tpl-orientation" value="vertical">
                                        <div class="orientation-toggle">
                                            <div class="orient-btn active" data-orient="vertical"><svg width="24" height="30" viewBox="0 0 24 30"><rect x="1" y="1" width="22" height="28" fill="none" stroke="currentColor" stroke-width="2"/><line x1="6" y1="8" x2="18" y2="8" stroke="currentColor" stroke-width="1.5"/><line x1="6" y1="13" x2="18" y2="13" stroke="currentColor" stroke-width="1.5"/><line x1="6" y1="18" x2="14" y2="18" stroke="currentColor" stroke-width="1.5"/></svg><span>Vertical</span></div>
                                            <div class="orient-btn" data-orient="horizontal"><svg width="30" height="24" viewBox="0 0 30 24"><rect x="1" y="1" width="28" height="22" fill="none" stroke="currentColor" stroke-width="2"/><line x1="6" y1="7" x2="24" y2="7" stroke="currentColor" stroke-width="1.5"/><line x1="6" y1="12" x2="24" y2="12" stroke="currentColor" stroke-width="1.5"/><line x1="6" y1="17" x2="18" y2="17" stroke="currentColor" stroke-width="1.5"/></svg><span>Horizontal</span></div>
                                        </div>
                                    </fieldset>
                                    <fieldset>
                                        <legend>Padding (mm)</legend>
                                        <label class="link-toggle linked" id="pad-link-toggle"><input type="checkbox" id="tpl-pad-link" checked><svg width="14" height="14" viewBox="0 0 16 16"><path d="M6 4H4a4 4 0 0 0 0 8h2M10 4h2a4 4 0 0 1 0 8h-2M5 8h6" fill="none" stroke="currentColor" stroke-width="2"/></svg><span>Linked</span></label>
                                        <div class="input-row">
                                            <div><label for="tpl-pad-top">Top</label><input type="number" id="tpl-pad-top" min="0" step="0.1" value="3"></div>
                                            <div><label for="tpl-pad-bottom">Bottom</label><input type="number" id="tpl-pad-bottom" min="0" step="0.1" value="3" disabled></div>
                                        </div>
                                        <div class="input-row">
                                            <div><label for="tpl-pad-left">Left</label><input type="number" id="tpl-pad-left" min="0" step="0.1" value="3" disabled></div>
                                            <div><label for="tpl-pad-right">Right</label><input type="number" id="tpl-pad-right" min="0" step="0.1" value="3" disabled></div>
                                        </div>
                                    </fieldset>
                                    <fieldset>
                                        <legend>Line Type</legend>
                                        <div class="line-type-toggle">
                                            <div class="line-type-btn active" data-linetype="sewing">Sewing</div>
                                            <div class="line-type-btn" data-linetype="fold">Mid Fold</div>
                                        </div>
                                        <div class="line-type-fields" id="fields-sewing">
                                            <div class="input-row">
                                                <div><label for="tpl-sew-position">Position</label>
                                                    <select id="tpl-sew-position">
                                                        <option value="top">Top</option>
                                                        <option value="bottom">Bottom</option>
                                                        <option value="left">Left</option>
                                                        <option value="right">Right</option>
                                                    </select>
                                                </div>
                                                <div><label for="tpl-sew-distance">Distance</label><input type="number" id="tpl-sew-distance" min="0" step="1" value="0"></div>
                                            </div>
                                        </div>
                                        <div class="line-type-fields hidden" id="fields-fold">
                                            <label for="tpl-fold-padding">Fold Padding (mm)</label>
                                            <input type="number" id="tpl-fold-padding" min="0" step="1" value="0">
                                        </div>
                                        <input type="hidden" id="tpl-fold" value="none">
                                        <input type="hidden" id="tpl-line-type" value="sewing">
                                    </fieldset>
                                    </fieldset>
                                    <div class="form-actions">
                                        <button type="submit" class="btn-icon" title="Save"><svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 8l4 4 8-8" fill="none" stroke="currentColor" stroke-width="2"/></svg></button>
                                        <button type="reset" class="btn-icon" title="Cancel"><svg width="16" height="16" viewBox="0 0 16 16"><path d="M3 3l10 10M13 3L3 13" fill="none" stroke="currentColor" stroke-width="2"/></svg></button>
                                        <button type="button" class="btn-icon btn-dummy" data-form="template-create" title="Dummy"><svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 4h12M2 8h12M2 12h8" fill="none" stroke="currentColor" stroke-width="2"/></svg></button>
                                    </div>
                                </form>
                            </div>
                            <div class="template-preview" id="template-preview">
                                <button type="button" class="btn-fit" title="Fit to view"><svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 2h4V0H0v6h2V2zm8-2v2h4v4h2V0h-6zm4 14h-4v2h6v-6h-2v4zM2 10H0v6h6v-2H2v-4z" fill="currentColor"/></svg></button>
                                <div class="preview-hint">Click "Preview" to see label layout.</div>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-tab: Partition -->
                    <div class="sub-tab-content" id="subtab-tpl-partition">
                        <div class="template-layout">
                            <div class="template-form" style="width:200px">
                                <label>Template</label>
                                <span id="partition-tpl-name" class="tpl-name-display"></span>
                                <p class="hint">Click and drag inside a partition to subdivide. Paste an image for reference.</p>
                                <button type="button" class="partition-action-btn" id="btn-reset-partitions">Reset</button>
                                <button type="button" class="partition-action-btn" id="btn-save-partitions">Save</button>
                                <button type="button" class="partition-action-btn" id="btn-edit-partitions">Edit</button>
                                <div id="partition-bg-controls" style="display:none">
                                    <label style="font-size:11px">Background</label>
                                    <div class="input-row" style="align-items:center;gap:4px;margin:4px 0">
                                        <button type="button" class="btn-icon" id="btn-bg-toggle" title="Toggle background visibility"><svg id="ico-eye-open" width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M1 8s2.5-5 7-5 7 5 7 5-2.5 5-7 5-7-5-7-5z"/><circle cx="8" cy="8" r="2.5"/></svg><svg id="ico-eye-closed" width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" style="display:none"><path d="M1 8s2.5-5 7-5 7 5 7 5-2.5 5-7 5-7-5-7-5z"/><line x1="3" y1="13" x2="13" y2="3"/></svg></button>
                                        <input type="range" id="partition-bg-opacity" min="0" max="100" value="30" style="flex:1" title="Background opacity">
                                        <span id="partition-bg-opacity-val" style="font-size:11px;width:30px;text-align:right">30%</span>
                                    </div>
                                    <button type="button" class="btn-outline" id="btn-bg-remove" style="font-size:11px;padding:2px 8px;margin-bottom:6px">Remove image</button>
                                </div>
                                <div id="partition-list"></div>
                            </div>
                            <div style="display:flex;flex-direction:column;flex:1;min-height:0">
                                <div class="page-tab-bar" id="page-tab-bar"></div>
                                <div class="template-preview" id="partition-preview">
                                    <button type="button" class="btn-fit" title="Fit to view"><svg width="16" height="16" viewBox="0 0 16 16"><path d="M2 2h4V0H0v6h2V2zm8-2v2h4v4h2V0h-6zm4 14h-4v2h6v-6h-2v4zM2 10H0v6h6v-2H2v-4z" fill="currentColor"/></svg></button>
                                    <div class="preview-hint">Select a template or drop a PDF.</div>
                                </div>
                                <button type="button" class="partition-action-btn" id="btn-add-page" style="align-self:flex-start;margin-top:6px">+ page</button>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-tab: Component -->
                    <div class="sub-tab-content" id="subtab-tpl-component">
                        <div class="template-layout">
                            <div class="template-form" style="width:200px">
                                <label for="comp-tpl-select">Template</label>
                                <select id="comp-tpl-select"></select>
                                <div style="margin-top:8px">
                                    <label class="btn" style="cursor:pointer;display:inline-block">Load PDF<input type="file" id="comp-pdf-input" accept=".pdf" style="display:none"></label>
                                    <button id="btn-comp-clear" class="btn">Clear</button>
                                </div>
                                <div id="comp-page-tabs" class="page-tab-bar"></div>
                                <h3 class="section-title">Components</h3>
                                <div class="component-item" draggable="true" data-type="text">Text</div>
                                <div class="component-item" draggable="true" data-type="paragraph">Paragraph</div>
                                <div class="component-item" draggable="true" data-type="barcode">Barcode</div>
                                <div class="component-item" draggable="true" data-type="qrcode">QR Code</div>
                                <h3 class="section-title">Placed</h3>
                                <div id="comp-placed-list" class="component-list"></div>
                                <div class="form-actions" style="margin-top:12px">
                                    <button id="btn-comp-save" class="btn">Save</button>
                                    <button id="btn-comp-reset" class="btn">Reset</button>
                                </div>
                                <h3 class="section-title">Export</h3>
                                <div class="form-actions">
                                    <button id="btn-export-pdf" class="btn">PDF</button>
                                    <button id="btn-export-ai" class="btn">AI Editable</button>
                                    <button id="btn-export-ai-outlined" class="btn">AI Outlined</button>
                                </div>
                            </div>
                            <div class="template-preview" id="component-preview">
                                <button class="btn-fit" id="btn-comp-fit" title="Fit">⊡</button>
                                <div class="preview-hint">Select a template or drop a PDF.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- View All -->
                <div class="tab-content" id="tab-template-view">
                    <div class="table-toolbar">
                        <input type="text" id="tpl-search" placeholder="Search templates...">
                    </div>
                    <div class="table-wrap">
                        <table id="table-templates">
                            <thead><tr><th>Name</th><th>Customer</th><th>Size</th><th>Orientation</th><th>Fold</th><th>Partitions</th><th></th></tr></thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ==================== PROJECT ==================== -->
            <section class="section-panel" id="section-project">
                <div class="tab-bar"><a class="tab active" data-tab="project-main">Project</a></div>
                <div class="tab-content active" id="tab-project-main"><p class="hint">Project module — details to follow.</p></div>
            </section>

            <!-- ==================== ORDER ==================== -->
            <section class="section-panel" id="section-order">
                <div class="tab-bar"><a class="tab active" data-tab="order-main">Order</a></div>
                <div class="tab-content active" id="tab-order-main"><p class="hint">Order module — details to follow.</p></div>
            </section>

            <!-- ==================== STATUS ==================== -->
            <section class="section-panel" id="section-status">
                <div class="tab-bar"><a class="tab active" data-tab="status-main">Order Status</a></div>
                <div class="tab-content active" id="tab-status-main"><p class="hint">Status module — details to follow.</p></div>
            </section>

        </main>
    </div>

    <div class="modal-overlay" id="app-modal-overlay">
        <div class="modal">
            <p id="app-modal-body"></p>
            <div class="modal-actions">
                <button id="app-modal-cancel">Cancel</button>
                <button id="app-modal-ok">OK</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>if(window.pdfjsLib)pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";</script>
    <script src="/static/js/core.js"></script>
    <script src="/static/js/nav.js"></script>
    <script src="/static/js/customer.js"></script>
    <script src="/static/js/supplier.js"></script>
    <script src="/static/js/template.js"></script>
    <script src="/static/js/partition.js"></script>
    <script src="/static/js/component.js"></script>
    <script src="/static/js/dummy.js"></script>
    <script src="/static/js/init.js"></script>
</body>
</html>
